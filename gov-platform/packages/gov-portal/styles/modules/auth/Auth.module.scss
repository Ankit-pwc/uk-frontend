@use "../../core/index" as *;
@use "../../layout/grid" as grid;
@use "../../components/brand";
@use "../../components/card";
@use "../../components/form-helpers";

/* Layout */
.authLayout {
  /* background image + overlay are layers */
  --bg-url: var(--login-bg-img, none);
  --bg-fit: var(--login-bg-fit, cover);
  --bg-pos: var(--login-bg-pos, center);
  --bg-overlay: var(--login-overlay, transparent);
  --bg-blur: var(--login-blur, 0px);

  min-height: 100vh;
  position: relative;
  overflow: hidden;
  background: var(--login-bg, #f6f7fb);
  padding: var(--login-pad, 24px);
}

/* background layer (image + overlay + blur) */
.bgLayer {
  position: absolute;
  inset: 0;
  pointer-events: none;

  &:before,
  &:after {
    content: "";
    position: absolute;
    inset: 0;
  }

  &:before {
    background-image: var(--bg-url);
    background-size: var(--bg-fit);
    background-position: var(--bg-pos);
    background-repeat: no-repeat;
    filter: none;
  }

  &:after {
    background: var(--bg-overlay);
    backdrop-filter: blur(var(--bg-blur));
    -webkit-backdrop-filter: blur(var(--bg-blur));
  }
}

/* Position helpers */
.pos-center {
  display: grid;
  place-items: center;
}

.pos-left {
  display: grid;
  place-items: center start;
}

.pos-right {
  display: grid;
  place-items: center end;
}

.pos-top-left {
  display: grid;
  place-items: start start;
}

.pos-top-right {
  display: grid;
  place-items: start end;
}

.pos-bottom-left {
  display: grid;
  place-items: end start;
}

.pos-bottom-right {
  display: grid;
  place-items: end end;
}

/* Card (glass) */
.authCard {
  --card-w: var(--login-card-w, 520px);
  --card-p: var(--login-card-p, 28px);
  --card-radius: var(--login-card-radius, 16px);
  --card-border: var(--login-card-border, 1px solid rgba(255, 255, 255, .5));
  @extend %cardRoot;

  /* glass look w/ safe backdrop */
  background: rgba(255, 255, 255, .75);
  border: var(--card-border);
  border-radius: var(--card-radius);
  max-width: var(--card-w);
  width: 100%;
  backdrop-filter: saturate(1.2) blur(8px);
  -webkit-backdrop-filter: saturate(1.2) blur(8px);
  box-shadow:
    0 10px 30px rgba(2, 6, 23, .08),
    0 4px 10px rgba(2, 6, 23, .04);
}

.authCardContent {
  display: flex;
  flex-direction: column;
  overflow: auto;
  @extend %cardContent;
}

/* Brand */
.brand {
  @extend %brand;
}

.brandLogo {
  width: var(--login-logo-w, 120px);
  height: var(--login-logo-h, 64px);
  display: inline-block;
}

.brandLogo img {
  width: 100%;
  height: 100%;
  object-fit: contain;
}

.brandTitle {
  @extend %brandTitle;
}

.brandSubtitle {
  @extend %brandSubtitle;
}

/* Grid */
.loginGrid {
  --grid-cols: var(--login-grid-cols, 12);
  --grid-gap: var(--login-grid-gap, 16px);
  @extend %grid;
  flex: 1 1 auto;
}

.gridItem {
  @extend %gridItem;
}

@include grid.gridResponsive();

/* Rows / Buttons / Errors */
.captchaRow {
  @extend %inlineRow;
  min-height: var(--captcha-h, 56px);
}

.submitRow {
  min-height: 56px;
  --btn-mt: var(--login-button-mt, 12px);
  @extend %submitRow;
}

.align-left {
  @extend %submitLeft;
}

.align-center {
  @extend %submitCenter;
}

.align-right {
  @extend %submitRight;
}

.submitBtn {
  width: 160px;
  @extend %submitBtn;
}

.fieldError {
  @extend %fieldError;
}

/* ---------- Animations (CLS-safe: transform/opacity only) ---------- */
.cardIn {
  will-change: transform, opacity;
}

.noMotion {
  animation: none !important;
  transform: none !important;
  opacity: 1 !important;
}

@keyframes fadeUpKf {
  from {
    opacity: 0;
    transform: translateY(12px)
  }

  to {
    opacity: 1;
    transform: none
  }
}

@keyframes scaleInKf {
  from {
    opacity: 0;
    transform: scale(.98)
  }

  to {
    opacity: 1;
    transform: none
  }
}

.fadeUp {
  animation: fadeUpKf var(--cardIn-duration, 500ms) ease-out both;
}

.scaleIn {
  animation: scaleInKf var(--cardIn-duration, 500ms) cubic-bezier(.2, .8, .2, 1) both;
}

/* ---------- Decorations ---------- */
.decor {
  position: absolute;
  width: var(--decor-size, 280px);
  height: var(--decor-size, 280px);
  opacity: var(--decor-opacity, .2);
  filter: blur(10px);
  pointer-events: none;
}

.decor-blob {
  border-radius: 50%;
  background: radial-gradient(circle at 30% 30%,
      hsla(var(--decor-hue, 220), 95%, 65%, .65),
      hsla(var(--decor-hue, 220), 95%, 55%, .35),
      transparent 70%);
  animation: floatKf var(--decor-speed, 24s) ease-in-out infinite alternate;
}

.decor-ring {
  border-radius: 50%;
  box-shadow: inset 0 0 0 30px hsla(var(--decor-hue, 220), 85%, 55%, .18),
    inset 0 0 0 2px hsla(var(--decor-hue, 220), 95%, 65%, .5);
  animation: driftKf var(--decor-speed, 30s) linear infinite;
}

@keyframes floatKf {
  from {
    transform: translateY(-8px)
  }

  to {
    transform: translateY(8px)
  }
}

@keyframes driftKf {
  from {
    transform: rotate(0deg)
  }

  to {
    transform: rotate(360deg)
  }
}